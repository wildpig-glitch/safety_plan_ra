/* eslint-disable @typescript-eslint/no-var-requires */
const { lstatSync, readdirSync, readFileSync, writeFileSync } = require('fs');
const { join } = require('path');

const isDirectory = (source) => lstatSync(source).isDirectory();
const packages = readdirSync('./packages')
  .map((name) => join('./packages', name))
  .filter(isDirectory);

packages.forEach((path) => {
  const packageJson = JSON.parse(readFileSync(`./${path}/package.json`, 'utf8'));

  packageJson.name = path.split('/')[path.split('/').length - 1].split('/')[0];

  writeFileSync(`./${path}/package.json`, JSON.stringify(packageJson, null, 2));
});
